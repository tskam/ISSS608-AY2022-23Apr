<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-12-04">

<title>ISSS608 - Take-home Exercise 2: Kick-starter 1: Building Network Data Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lesson.html" rel="" target="">
 <span class="menu-text">Lesson Plan</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../take-home_ex/TH_EX01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../take-home_ex/TH_EX02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../take-home_ex/TH_EX03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../take-home_ex/TH_EX04.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../VAproject.html" rel="" target="">
 <span class="menu-text">Visual Analytics Project</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-shiny-workshop" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Shiny Workshop</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-shiny-workshop">    
        <li>
    <a class="dropdown-item" href="../../ShinyWorkshop/Shiny1/Shiny1.html" rel="" target="">
 <span class="dropdown-text">R Shiny basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ShinyWorkshop/Shiny2/Shiny2.html" rel="" target="">
 <span class="dropdown-text">Beyond the basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ShinyWorkshop/Shiny3/Shiny3.html" rel="" target="">
 <span class="dropdown-text">Customising Shiny</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ShinyResources.html" rel="" target="">
 <span class="dropdown-text">Shiny Resources</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../Tableau.html" rel="" target="">
 <span class="menu-text">Tableau Resources</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-all-about-r" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">All About R</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-all-about-r">    
        <li>
    <a class="dropdown-item" href="../../R.html" rel="" target="">
 <span class="dropdown-text">R Resouces</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../R4Vis.html" rel="" target="">
 <span class="dropdown-text">R for Visual Analytics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Rt.html" rel="" target="">
 <span class="dropdown-text">R tips &amp; tricks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Quarto.html" rel="" target="">
 <span class="dropdown-text">Quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../git.html" rel="" target="">
 <span class="dropdown-text">git and github</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#extracting-the-nodes" id="toc-extracting-the-nodes" class="nav-link" data-scroll-target="#extracting-the-nodes">Extracting the nodes</a></li>
  <li><a href="#extracting-the-edges" id="toc-extracting-the-edges" class="nav-link" data-scroll-target="#extracting-the-edges">Extracting the edges</a></li>
  <li><a href="#preparing-edges-data-table" id="toc-preparing-edges-data-table" class="nav-link" data-scroll-target="#preparing-edges-data-table">Preparing edges data table</a></li>
  </ul></li>
  <li><a href="#preparing-nodes-data" id="toc-preparing-nodes-data" class="nav-link" data-scroll-target="#preparing-nodes-data">Preparing nodes data</a></li>
  <li><a href="#building-the-tidy-graph-data-model" id="toc-building-the-tidy-graph-data-model" class="nav-link" data-scroll-target="#building-the-tidy-graph-data-model">Building the tidy graph data model</a>
  <ul class="collapse">
  <li><a href="#visualising-the-network-graph-with-ggraph" id="toc-visualising-the-network-graph-with-ggraph" class="nav-link" data-scroll-target="#visualising-the-network-graph-with-ggraph">Visualising the network graph with ggraph</a></li>
  <li><a href="#exporting-data-objects" id="toc-exporting-data-objects" class="nav-link" data-scroll-target="#exporting-data-objects">Exporting data objects</a></li>
  </ul></li>
  <li><a href="#preparing-network-data-for-visnetwork" id="toc-preparing-network-data-for-visnetwork" class="nav-link" data-scroll-target="#preparing-network-data-for-visnetwork">Preparing Network Data for visNetwork</a>
  <ul class="collapse">
  <li><a href="#preparing-edges-tibble-data-frame" id="toc-preparing-edges-tibble-data-frame" class="nav-link" data-scroll-target="#preparing-edges-tibble-data-frame">Preparing edges tibble data frame</a></li>
  </ul></li>
  <li><a href="#things-to-learn-from-the-code-chunk-above" id="toc-things-to-learn-from-the-code-chunk-above" class="nav-link" data-scroll-target="#things-to-learn-from-the-code-chunk-above">Things to learn from the code chunk above</a></li>
  <li><a href="#preparing-nodes-tibble-data-frame" id="toc-preparing-nodes-tibble-data-frame" class="nav-link" data-scroll-target="#preparing-nodes-tibble-data-frame">Preparing nodes tibble data frame</a></li>
  <li><a href="#plotting-a-simple-interactive-network-graph" id="toc-plotting-a-simple-interactive-network-graph" class="nav-link" data-scroll-target="#plotting-a-simple-interactive-network-graph">Plotting a simple interactive network graph</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2: Kick-starter 1: Building Network Data Models</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 4, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 1, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Declaimer
</div>
</div>
<div class="callout-body-container callout-body">
<p>This document aims to provide you guidance on how to get started with Takehome Exercise 2, especially how to prepare the network data. It is not a model answer.</p>
</div>
</div>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>The code chunk below will be used to install and load the necessary R packages to meet the data preparation, data wrangling, data analysis and visualisation needs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite, tidygraph, ggraph, visNetwork, lubridate, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-import" class="level2">
<h2 class="anchored" data-anchor-id="data-import">Data Import</h2>
<p>In the code chunk below, <code>fromJSON()</code> of <strong>jsonlite</strong> package is used to import <em>mc2_challenge_graph.json</em> into R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc2_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="Callout-note">
<p>Examine the list object created by using RStudio, especially <em>nodes</em> and <em>links</em> data tables.</p>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<section id="extracting-the-nodes" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-nodes">Extracting the nodes</h3>
<p>The code chunk is used to extract <em>nodes</em> data table from <em>mc2_data</em> list object and save the output in a tibble data frame object called <em>mc2_nodes</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, shpcountry, rcvcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Thing to learn
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>select()</code> is used not only to select the field needed but also to re-organise the sequent of the fields.</li>
</ul>
</div>
</div>
</section>
<section id="extracting-the-edges" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-edges">Extracting the edges</h3>
<p>The code chunk is used to extract <em>edgess</em> data table from <em>mc2_data</em> list object and save the output in a tibble data frame object called <em>mc2_edges</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ArrivalDate =</span> <span class="fu">ymd</span>(arrivaldate)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(ArrivalDate)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, ArrivalDate, Year, hscode, valueofgoods_omu, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         volumeteu, weightkg, valueofgoodsusd) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>mutate()</code> is used two times to create two derive fields.
<ul>
<li><code>ymd()</code> of <strong>lubridate</strong> package is used to covert <em>arrivaldate</em> field from character data type into date data type.</li>
<li><code>year()</code> of <strong>lubridate</strong> package is used to convert the values in ArrivalDate field into year values.</li>
</ul></li>
<li><code>select()</code> is used not only to select the field needed but also to re-organise the sequent of the fields.</li>
</ul>
</div>
</div>
</section>
<section id="preparing-edges-data-table" class="level3">
<h3 class="anchored" data-anchor-id="preparing-edges-data-table">Preparing edges data table</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk below
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>filter()</code> is used to select records whereby hscode is equal 306170 and Year is equal to 2028.</li>
<li><code>group_by()</code> is used to aggregate values by source, target, hscode, Year.</li>
<li><code>summarise()</code> and <code>n()</code> are used to count the aggregated records.</li>
<li>filter() is then used to perform two selections
<ul>
<li>to select all records whereby source are not equal to target, and</li>
<li>to select all records whereby the values of their weights field are greater than 20</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_aggregated <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"306170"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2028"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weights <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preparing-nodes-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-nodes-data">Preparing nodes data</h2>
<p>Instead of using the nodes data table extracted from <em>mc2_data</em>, we will prepare a new nodes data table by using the source and target fields of <code>mc2_edges_aggregated</code> data table. This is necessary to ensure that the nodes in nodes data tables include all the source and target values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>mc2_nodes_extracted <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="building-the-tidy-graph-data-model" class="level2">
<h2 class="anchored" data-anchor-id="building-the-tidy-graph-data-model">Building the tidy graph data model</h2>
<p>The code chunk below is then used to build the tidy graph data model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc2_nodes_extracted,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> mc2_edges_aggregated,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualising-the-network-graph-with-ggraph" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-network-graph-with-ggraph">Visualising the network graph with ggraph</h3>
<p>In order to check if the tidygraph model has been prepared correctly, we can use selected functions of <strong>ggraph</strong> package to plot a simple network graph as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc2_graph,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="MC2-Kick-starter1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exporting-data-objects" class="level3">
<h3 class="anchored" data-anchor-id="exporting-data-objects">Exporting data objects</h3>
<p>Code chunk below will be used to export the data objects prepared in previous section into rds format for subsequent use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_nodes_extracted, <span class="st">"data/mc2_nodes_extracted.rds"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_edges_aggregated, <span class="st">"data/mc2_edges_aggregated.rds"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_graph, <span class="st">"data/mc2_graph.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preparing-network-data-for-visnetwork" class="level2">
<h2 class="anchored" data-anchor-id="preparing-network-data-for-visnetwork">Preparing Network Data for visNetwork</h2>
<p>Instead of plotting static network graph, we can plot interactive network graph by using visNetwork package. Before we can plot a interactive network graph by using visNetwork package, we are required to prepare two tibble data frames, one for the nodes and the other one for the edges.</p>
<section id="preparing-edges-tibble-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="preparing-edges-tibble-data-frame">Preparing edges tibble data frame</h3>
<p>In this example, we assume that you already have created a tidygraph model look similar to the print below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mc2_graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 123 nodes and 146 edges
#
# A directed acyclic simple graph with 12 components
#
# A tibble: 123 × 1
  id                                             
  &lt;chr&gt;                                          
1 1 Ltd. Liability Co Cargo                      
2 Adriatic Catch Ltd. Liability Co Transportation
3 Adriatic Tuna AS Solutions                     
4 Amerigo Dockyard S.p.A. Distribution           
5 Aqua Adventures Carriers Seabed                
6 Aqua Azul LC International                     
# ℹ 117 more rows
#
# A tibble: 146 × 5
   from    to hscode  Year weights
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;
1     1    74 306170  2028      68
2     2    75 306170  2028      30
3     3    76 306170  2028      22
# ℹ 143 more rows</code></pre>
</div>
</div>
<p>Note that tidygraph model is in R list format. The code chunk below will be used to extract and convert the edges into a tibble data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>edges_df <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="things-to-learn-from-the-code-chunk-above" class="level2 callout-node">
<h2 class="anchored" data-anchor-id="things-to-learn-from-the-code-chunk-above">Things to learn from the code chunk above</h2>
<ul>
<li><code>activate()</code> is used to make the edges of mc2_graph1 active. This is necessary in order to extract the correct compontent from the list object.</li>
<li><code>as.tibble()</code> is used to convert the edges list into tibble data frame.</li>
</ul>
</section>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You might be curious to ask why don’t we used <em>mc2_edges</em>, the tibble data frame extracted in the earlier section. If you compare the data structure of both data frames, you will notice the first two field names in <em>edges_df</em> are called <em>from</em> and <em>to</em> instead of <em>source</em> and <em>target</em>. This is conformed to the nodes data structure of igraph object. Also note that the data type of <em>from</em> and <em>to</em> are in numeric data type and not in character data type.</p>
</div>
</div>
<section id="preparing-nodes-tibble-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="preparing-nodes-tibble-data-frame">Preparing nodes tibble data frame</h3>
<p>In this section, we will prepare a nodes tibble data frame by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nodes_df <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>activate()</code> is used to make the edges of mc2_graph1 active. This is necessary in order to extract the correct compontent from the list object.</li>
<li><code>as.tibble()</code> is used to convert the edges list into tibble data frame.</li>
<li><code>rename()</code> is used to rename the field name id to label.</li>
<li><code>mutate()</code> is used to create a new field called id and <code>row_number()</code> is used to assign the row number into id values.</li>
<li><code>select()</code> is used to re-organised the field name. This is because visNerwork is expecting the first field is called id and the second field is called label.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>visNetowrk is expecting a field called <em>id</em> in the tibble data frame. The field must be in numeric data type and it must unique to the values in the from and to field of edges_df.<br>
</li>
</ul>
</div>
</div>
</section>
<section id="plotting-a-simple-interactive-network-graph" class="level3">
<h3 class="anchored" data-anchor-id="plotting-a-simple-interactive-network-graph">Plotting a simple interactive network graph</h3>
<p>To ensure that the tibble data frames are confirmed to the requirements of visNetwork, we will plot a simple interactive graph by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>           edges_df) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">smooth =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"curvedCW"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-42391ef78f98d7e71f7f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-42391ef78f98d7e71f7f">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123],"label":["1 Ltd. Liability Co Cargo","Adriatic Catch Ltd. Liability Co Transportation","Adriatic Tuna AS Solutions","Amerigo Dockyard S.p.A. Distribution","Aqua Adventures Carriers Seabed","Aqua Azul LC International","Arunachal Pradesh s Plc","Balkan Cat ОАО Transport","Bay of Bengal's Corp","Blue Horizon Family &","Chuan gou  N.V. Delivery","CoralCove Foods AG Marine conservation","Costa del Mar Ges.m.b.H. Marine biology","Costa del Viento A/S Freight ","Daniel Ferry N.V. Transit","Danish Plaice BV Investment","Danish Plaice Ltd. Liability Co Logistics","Donald Sp & Son's","Dutch Bill  Marine mist NV Freight ","Dutch Eel AB Holdings","Finests  Salmon Ltd Marine ecology","French  Seabed S.p.A. Forwading","Haryana s Plc Transit","Irish Scallop Corporation Transport","Italian Sardines Ltd. Liability Co","Lake Tana  & Son's","Ltd. Corporation Ltd. Liability Co","Manipur  Market Corporation Cargo","Mar de la Costa Sagl","Mar de la Felicidad BV","Mar de la Felicidad NV","Mar de la Vida S.p.A.","Mar del Oeste Cruise ship","Mar del Placer CJSC Transport","Marine Masterminds SE Saltwater","Michael Ltd. Corporation Seal","Neptune's Realm NV Navigation","Noord Limited Liability Company Line","Náutica del Sol Brothers","Ob River Ltd. Liability Co","Ocean Emporium Pic Holdings","Ocean Outfitters Ltd. Corporation","Oceanfront Oases Co Shipping","Oceanfront Oasis Company Green ","Perla del Mar BV","Perla del Mar Deep-sea","Playa de Arena OJSC Express","Playa del Mar Corporation","ReefRider Foods S.p.A. Cargo","Richard S.A. de C.V. Solutions","Rift Valley fishery Sagl","Rufiji River  Ges.m.b.H. Family","Saltwater Sirens Limited Liability Company Marine conservation","SeaBass  Ltd. Liability Co Consulting","Selous Game Reserve  AB","Spanish Shrimp A/S Marine","Surf and Sea Marine","Tamil Nadu s Barge","The Sea Lion Corporation","Tripura  Market S.A. de C.V.","Tristen Jetty Company Solutions","Turkish Sword NV Ocean","Uttar Pradesh Sea  A/S Express","Viento Azul N.V. Distribution","Viento y Mar BV","Wave Watchers Ltd. Liability Co","bǐ mù yú AG Marine","bǐ mù yú Sagl Distribution","guī yú Ltd. Corporation","qīng yú Ltd. Corporation","shí rén yú Marine conservation","suō yú GmbH & Co. KG Freight ","xiǎo lóng xiā SRL","Himachal Pradesh  BV Holdings","The Sea Turtle GmbH & Co. KG","AquaDelight N.V. Coral Reef","Caracola del Sol Services","Shou gan  Limited Liability Company Distribution","Caracola del Este Ltd. Liability Co","Casablanca Coast  Flounder Oyj Line","Lake Turkana  Charter Boat  NV Marine","Sea Breeze Corporation Marine sanctuary","-5669","-5670","Arunachal Pradesh s Brine","Costa de la Felicidad Shipping","Mar del Este CJSC","Dubingiai Ltd. Liability Co","Coastal Castaway Coast Corporation Worldwide","Madagascar Coast  AG Freight ","Mar del Paraíso Corporation Logistics","Selous Game Reserve  S.A. de C.V.","hǎi dǎn AG Express","hǎi dǎn Corporation Wharf","hǎi mǎ Sagl Express","SeaLion Marine AG Express","Punjab s Marine conservation","Pao gan SE Seal","Arena del Mar Marine Marine biology","Maharashtra  Ltd. Liability Co Shipping","Saltwater Supreme Pelican Ltd Enterprises","West Bengal   OJSC Transport","Tripura  Pier N.V. Solutions","Mar del Placer Manatee","3 Oceanography ОАО Marine life","Water Wonders AG Transport","Rybachit Sagl and Son's","-1363","Kilimanjaro fishery Ltd. Corporation Carriers","-1539","Coral Cove BV Delivery","Isla del Tesoro GmbH & Co. KG Chart","Pao gan LC Freight ","Brisa del Este BV","Playa de Arena SE Underwater","Yu xian  SRL Industrial","Black Sea Tuna Snapper","Mar de la Luz Plc","Assam  Market Cargo ship Company Marine conservation","Sailors and Surfers Incorporated Enterprises","-1203","Mar de Plata BV Marine","Selkie Ltd. Liability Co"],"x":[-0.816832109780464,-0.661140184893828,0.370790842707357,-0.989326314573882,-0.0214440899917159,-0.414912030224694,0.853516618224399,0.236555571089792,0.573186013612633,-0.237475355680736,0.560907522878256,0.119426084759653,0.636776672830002,-0.0698199835531622,0.644848668857479,-0.66599581384208,-0.3013924058477,-0.198137448567454,-0.659912180176428,-0.350825741532847,0.468877543655269,0.107959844854199,0.162601571703152,-0.718654958446676,0.580802724870676,0.0782328681899611,0.350480636384967,0.217650865076795,-1,0.602691598183456,-0.538587170418079,-0.0324319409864976,0.00209948600461662,-0.265568690774136,-0.248445194128842,0.0378579421871035,-0.179182187765338,0.303153110292576,0.681553241562756,0.1977622707185,-0.346723649558999,-0.250198552439928,0.415903079409898,0.535866475676338,-0.699449555290151,-0.17512752118131,0.330526017741506,-0.0628273344215987,-0.849946136370211,0.609342764601822,1,-0.188581168805701,0.131154413712265,-0.318701690828659,-0.693569290726135,0.162940072992551,0.730168540403622,-0.600731281470097,0.530321256965883,0.0331066996807829,-0.364360043132264,-0.266911016458134,0.34201840473297,0.613193078404668,-0.108998878738224,0.0502251252549917,0.284161042089115,-0.449811381585142,-0.132897274831837,0.689485758290831,0.394791466099611,-0.0120549307539104,0.324635497853143,-0.733545875278675,-0.484846152772358,0.425060393026516,0.180284864500219,-0.996534143228719,0.249109037699739,-0.146513402084401,-0.271841974787674,0.158137893368989,-0.529123730101169,-0.591271508226798,-0.592083046154777,-0.466591403312565,-0.139957186978668,0.706579138404264,0.462449608477989,-0.0560188441697496,0.17172592363743,0.41681703324269,0.350630928823213,-0.101026282101147,0.292461304223814,0.763699217302326,-0.0881143371502898,-0.471142399785335,-0.50649238645004,-0.267199948428494,0.364564963718948,0.113964230179199,0.112882907090212,0.168030242981429,-0.987344320667144,-0.594085345179511,-0.239017799863747,0.221277067461629,0.111940863634402,-0.323403586232106,0.454989299646186,-0.834505283044984,0.377323974100598,0.0567778513703827,-0.0960286727820225,-0.814708110088578,0.912107048697261,0.462138072665792,0.730873408865085,0.209625502989659,-0.40249337347635,0.759639046909507,-0.0523652830502878],"y":[0.512047257604247,-0.614294281417792,-0.367946861254096,-0.259769381927327,-0.147009024977875,0.0806525601571724,0.226937144372836,-0.161855044085634,-0.473476263117527,-0.328199881032107,-0.110717149547715,-0.420776207205588,-0.231818309072641,-0.790485418046681,-0.441932649043873,-0.239081227735918,-0.311593370298524,-0.831042911592748,-0.151167375047786,-0.567779764010883,0.307985273751775,-0.603203198367153,0.356014781816985,0.658796588686101,0.17264753604349,-0.198838306827521,-0.304128593281522,-0.469001864864872,0.138846773609883,-0.664884778082213,0.700251975719972,-0.512538451069473,-0.367152083791579,-0.739672970278388,-0.621272516467881,-0.223432042806526,0.819298194423251,0.865725768584826,-0.357144113023162,1,-0.12905358241404,0.184189190431668,0.466081567076476,-0.729708186961471,-0.333126422559097,-0.120784608637886,-0.222697721043342,0.337940943218817,0.237425152694986,-0.342149877340946,-0.0942375566866617,-0.720726285368938,0.180184439318836,-0.671569854812883,-0.0452719800227417,-0.0701746656175145,-0.243883793942748,-0.702740220320289,0.830645769365596,-0.0617077594597424,-0.236872196527594,0.985448160805659,-0.729211167578593,0.260960635717145,-0.726829639177815,-0.509309353443291,-0.581440284239737,0.890696570915177,0.234434528350103,0.702991271526314,-0.785726169070037,0.89065496602396,-0.0227650828877947,0.562869366677638,-0.54623554619967,-0.292005539567104,-0.186935359817769,-0.156452706678424,-0.290677256515136,0.0643924072943809,-0.0347540921792748,-0.36242166685468,0.252886608384054,0.111231231700651,0.203681545581095,0.29767964999994,-0.216955844111179,0.129412453174747,-0.0207554044808496,0.00233521471159293,0.0298921910691792,-0.539112881617793,0.205497793024103,-0.507390823081166,0.0928751780580497,-0.0343602273343377,-0.326521135656785,-0.199774568082592,-0.389021490050462,-1,0.085038709375814,-0.864372501678934,0.105475493056914,-0.667001921040525,0.239355062102504,0.775869128673084,0.892928425188126,0.820480076551048,0.996661054611418,0.398747460624332,0.61817438863019,-0.416747417336163,-0.085471797581811,0.409412833359135,0.547004804957556,0.0998720364321135,-0.189277763819829,0.884253951348473,0.402072587371143,-0.762917059564602,0.809651826254324,0.637753859564322,0.983505191298026]},"edges":{"from":[1,2,3,3,4,5,5,5,5,6,6,6,6,6,6,7,8,8,8,8,8,8,8,8,8,9,10,10,10,10,11,11,11,11,12,12,12,13,14,15,16,17,17,17,17,18,18,19,20,20,21,22,22,22,23,24,25,25,26,26,26,26,26,27,28,28,28,29,30,31,32,32,33,33,33,34,35,36,36,36,36,36,36,37,38,39,40,41,42,42,42,43,43,44,45,45,46,46,47,47,47,47,48,48,48,49,50,51,52,53,53,54,55,55,56,56,56,56,56,56,57,57,58,59,60,60,60,61,62,63,63,64,64,64,65,66,66,66,67,68,69,70,71,71,72,73],"to":[74,75,76,77,78,79,80,81,82,83,84,85,86,81,87,88,76,79,89,90,91,92,93,94,95,76,90,87,75,94,76,79,88,96,76,97,94,76,94,76,98,99,81,87,94,100,94,98,75,94,101,79,102,94,103,74,88,101,76,90,87,103,94,92,77,104,82,105,92,106,87,104,77,97,94,94,94,76,77,98,101,82,94,107,108,76,109,87,110,81,90,111,93,92,112,98,90,97,76,77,113,82,114,90,115,116,76,117,94,114,77,94,98,116,27,90,87,113,101,103,76,117,75,118,77,87,91,87,107,104,92,119,88,101,94,87,120,82,82,121,90,122,120,92,123,77],"hscode":["306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170"],"Year":[2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028],"weights":[68,30,22,21,42,80,23,42,46,54,21,234,30,33,22,28,126,31,23,36,66,36,62,29,37,54,61,21,23,45,63,182,24,24,64,89,44,40,73,176,95,34,65,21,134,50,29,25,191,80,24,42,22,35,120,68,28,50,101,49,40,25,39,83,246,127,59,25,49,80,43,22,135,35,26,26,173,21,26,34,36,32,27,183,73,96,21,64,35,41,57,41,82,63,28,44,70,115,23,30,36,27,79,40,37,24,36,41,62,25,46,59,63,26,125,72,26,90,55,36,122,22,57,30,23,22,21,204,260,36,74,21,37,28,36,456,67,25,35,33,32,164,32,44,58,30]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":true,"type":"curvedCW"}},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>